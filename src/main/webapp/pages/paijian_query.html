<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>派件运单综合查询</title>

<link rel="stylesheet" href="css/wanma.css">

<link rel="stylesheet" href="../tools/easyui/themes/default/easyui.css">
<link rel="stylesheet" href="../tools/easyui/themes/icon.css">

<script src="../tools/easyui/jquery.min.js"></script>
<script src="../tools/easyui/jquery.easyui.min.js"></script>
<script src="../tools/easyui/datagrid-filter.js"></script>
<script src="../tools/easyui/easyui-lang-zh_CN.js"></script>

<script src="js/common.js"></script>

<style type="text/css">
    

</style>

<script type="text/javascript">

/* 
 *  可查看有多少运单需要进行派件，多少完成派件，并且对需要派件的订单提前知道是否有代收货款等特殊要求。
 *  网点只能查看自己作为派件站点的运单信息，网管能够查看到所管网点的所有派件运单信息.
 */

$(document).ready(function(){

    query();

});

var FIELDS_1 = [
        { field : 'f1', title : '到货日期', width : 80, sortable: true},
        { field : 'f2', title : '寄件网点', width : 60 },
        { field : 'f3', title : '运单编号', width : 90, align: "center", styler: 
            function(value, row, index){
                if (value){
                    return 'cursor: pointer;';
                }
            } 
        }, 
        { field : 'f4', title : '签收状态', width : 70 }
    ],
    FIELDS_2 = [
        { field : 'f5', title : '货物数量', width : 70 }, 
        { field : 'f6', title : '货物体积', width : 70 }, 
        { field : 'f7', title : '货物重量', width : 70 }, 
        { field : 'f8', title : '折扣', width : 70 }, 
        { field : 'f9', title : '计费重量', width : 70 },

        { field : 'fa', title : '收件客户地址', width : 150 }, 
        { field : 'fb', title : '收件客户电话', width : 90 }, 
        { field : 'fc', title : '代收货款金额', width : 80 }, 
        { field : 'fd', title : '电子面单', width : 60 }, 
        { field : 'fe', title : '派件员', width : 70, sortable: true }, 
        { field : 'ff', title : '派件网点', width : 70 }, 
        { field : 'fg', title : '签收时间', width : 80 }
    ];

function query(params) {
    params = params || {};

    var dg = $('#t1').datagrid({
        url: 'data/paijian_2.json',
        method : 'get',
        queryParams: params,
        fit : true,
        fitColumns : false,
        pageSize : 1000,
        rownumbers : true,
        singleSelect : true,
        checkOnSelect : true,
        selectOnCheck : true,
        remoteSort : false,
        multiSort : true,
        nowrap: false,
        sortName : "f1",
        sortOrder : "desc",
        frozenColumns: [FIELDS_1], 
        columns : [FIELDS_2],
        onHeaderContextMenu: function(e, field){
            e.preventDefault();
            if (!cmenu){
                createColumnMenu();
            }
            cmenu.menu('show', {left:e.pageX, top:e.pageY});
        },
        rowStyler: function(index, row) {
            if (row.hasW){
                return 'background-color:red;';
            }
        },
        onDblClickCell: function(index, field, value) {
            if(field !== 'f3') return;
            $.messager.alert({
                title: '提示',
                msg: '打开运单【'+value+'】的《快件跟踪查询》和《问题件信息查询》'
            });
        }
    });

    dg.datagrid('enableFilter', [{
            field:'id',
            type:'numberbox',
            options:{precision:1},
            op:['equal','notequal','less','greater']
        }]);
}

function beginQuery() {
    var params = {};
    params.code = $('#param1').val();

    query(params);
}

</script>

</head>
<body>
    <div id="main" class="easyui-layout" fit="true" >
        <div id="queryContainer" data-options="region:'north'" border="false">
            查询条件：
            <input id="param1" class="easyui-textbox" data-options="prompt:'运单号/寄件网点'" style="width:400px"/>
            <a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-search'" onclick='beginQuery()'>查询</a>
            &nbsp;&nbsp;
            <a href="#" class="easyui-linkbutton" onclick='moreParams()'>业务员关联</a>&nbsp;
        </div>
        <div id="dataContainer" data-options="region:'center'" border="false" title="寄件运单综合查询">
            <table id="t1" border="false"></table>
        </div>
    </div>

</body>
</html>